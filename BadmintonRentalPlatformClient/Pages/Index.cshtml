@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

<!-- Hero Section Begin -->
<section class="hero-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="hero-text">
                    <h1>Badminton Rental Platform</h1>
                    <p>
                        Here are the best badminton court booking platforms,
                        including recommendations for international bookings and finding courts at affordable prices.
                    </p>
                    <a href="#" class="primary-btn">Discover Now</a>
                </div>
            </div>
            <div class="col-xl-4 col-lg-5 offset-xl-2 offset-lg-1">
                <div class="booking-form">
                    <h3>Booking Your Badminton Court</h3>
                    <form action="#">
                        <div class="check-date">
                            <label for="date-booking">Date Booking:</label>
                            <input type="text" class="date-input" id="date-in">
                            <i class="icon_calendar"></i>
                        </div>
                        <div class="check-date">
                            <label for="start-time">Start Time:</label>
                            <input type="time" class="date-input" id="start-time" step="1800">
                        </div>
                        <div class="check-date">
                            <label for="end-time">End Time:</label>
                            <input type="time" class="date-input" id="end-time" step="1800">
                        </div>
                        <div class="select-option">
                            <label for="guest">People:</label>
                            <select id="guest">
                                <option value="2">2 People</option>
                                <option value="3">3 People</option>
                            </select>
                        </div>
                        <div class="select-option">
                            <label for="room">Court:</label>
                            <select id="room">
                                <option value="1">1 Court</option>
                                <option value="2">2 Court</option>
                            </select>
                        </div>
                        <button type="submit">Check Availability</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="hero-slider owl-carousel">
        <div class="hs-item set-bg" data-setbg="img/hero/hero-1.jpg"></div>
        <div class="hs-item set-bg" data-setbg="img/hero/hero-2.jpg"></div>
        <div class="hs-item set-bg" data-setbg="img/hero/hero-3.jpg"></div>
    </div>
</section>
<!-- Hero Section End -->
<!-- About Us Section Begin -->
<section class="aboutus-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="about-text">
                    <div class="section-title">
                        <span>About Us</span>
                        <h2>Leading Badminton Court <br />Booking Platform</h2>
                    </div>
                    <p class="f-para">
                        Welcome to our Badminton Court Rental Platform, your one-stop destination for booking
                        premium badminton courts. We offer a seamless and user-friendly experience to help you find
                        and book courts at the best prices, whether you're a casual player or a professional.
                    </p>
                    <p class="s-para">
                        Our platform is designed to provide you with detailed information about each court, including
                        availability, pricing, and amenities, making it easy for you to choose the perfect court for
                        your needs. Join our community of badminton enthusiasts and enjoy a hassle-free booking experience.
                    </p>
                    <a href="#" class="primary-btn about-btn">Read More</a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="about-pic">
                    <div class="row">
                        <div class="col-sm-6">
                            <img src="img/about/about-1.jpg" alt="">
                        </div>
                        <div class="col-sm-6">
                            <img src="img/about/about-2.jpg" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- About Us Section End -->
<!-- Badminton Court Section Begin -->
<section class="hp-room-section">
    <div class="container-fluid">
        <div class="hp-room-items">
            <div class="row" id="badminton-court-section">
                <!-- Nội dung sẽ được JavaScript chèn vào đây -->
            </div>
        </div>
    </div>
</section>
<!-- Badminton Court Section End -->
<!-- Testimonial Section Begin -->
<section class="testimonial-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title">
                    <span>Testimonials</span>
                    <h2>What Customers Say?</h2>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 offset-lg-2">
                <div class="testimonial-slider owl-carousel">
                    <div class="ts-item">
                        <p>
                            After a construction project took longer than expected, my husband, my daughter and I
                            needed a place to stay for a few nights. As a Chicago resident, we know a lot about our
                            city, neighborhood and the types of housing options available and absolutely love our
                            vacation at Sona Hotel.
                        </p>
                        <div class="ti-author">
                            <div class="rating">
                                <i class="icon_star"></i>
                                <i class="icon_star"></i>
                                <i class="icon_star"></i>
                                <i class="icon_star"></i>
                                <i class="icon_star-half_alt"></i>
                            </div>
                            <h5> - Alexander Vasquez</h5>
                        </div>
                        <img src="img/testimonial-logo.png" alt="">
                    </div>
                    <div class="ts-item">
                        <p>
                            After a construction project took longer than expected, my husband, my daughter and I
                            needed a place to stay for a few nights. As a Chicago resident, we know a lot about our
                            city, neighborhood and the types of housing options available and absolutely love our
                            vacation at Sona Hotel.
                        </p>
                        <div class="ti-author">
                            <div class="rating">
                                <i class="icon_star"></i>
                                <i class="icon_star"></i>
                                <i class="icon_star"></i>
                                <i class="icon_star"></i>
                                <i class="icon_star-half_alt"></i>
                            </div>
                            <h5> - Alexander Vasquez</h5>
                        </div>
                        <img src="img/testimonial-logo.png" alt="">
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Testimonial Section End -->
<!-- Blog Section Begin -->
@*<section class="blog-section spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section-title">
                        <span>Hotel News</span>
                        <h2>Our Blog & Event</h2>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="blog-item set-bg" data-setbg="img/blog/blog-1.jpg">
                        <div class="bi-text">
                            <span class="b-tag">Travel Trip</span>
                            <h4><a href="#">Tremblant In Canada</a></h4>
                            <div class="b-time"><i class="icon_clock_alt"></i> 15th April, 2019</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="blog-item set-bg" data-setbg="img/blog/blog-2.jpg">
                        <div class="bi-text">
                            <span class="b-tag">Camping</span>
                            <h4><a href="#">Choosing A Static Caravan</a></h4>
                            <div class="b-time"><i class="icon_clock_alt"></i> 15th April, 2019</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="blog-item set-bg" data-setbg="img/blog/blog-3.jpg">
                        <div class="bi-text">
                            <span class="b-tag">Event</span>
                            <h4><a href="#">Copper Canyon</a></h4>
                            <div class="b-time"><i class="icon_clock_alt"></i> 21th April, 2019</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="blog-item small-size set-bg" data-setbg="img/blog/blog-wide.jpg">
                        <div class="bi-text">
                            <span class="b-tag">Event</span>
                            <h4><a href="#">Trip To Iqaluit In Nunavut A Canadian Arctic City</a></h4>
                            <div class="b-time"><i class="icon_clock_alt"></i> 08th April, 2019</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="blog-item small-size set-bg" data-setbg="img/blog/blog-10.jpg">
                        <div class="bi-text">
                            <span class="b-tag">Travel</span>
                            <h4><a href="#">Traveling To Barcelona</a></h4>
                            <div class="b-time"><i class="icon_clock_alt"></i> 12th April, 2019</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>*@
<!-- Blog Section End -->
<!-- Search model Begin -->
<div class="search-model">
    <div class="h-100 d-flex align-items-center justify-content-center">
        <div class="search-close-switch"><i class="icon_close"></i></div>
        <form class="search-model-form">
            <input type="text" id="search-input" placeholder="Search here.....">
        </form>
    </div>
</div>
<!-- Search model end -->
<script>
    document.addEventListener('DOMContentLoaded', async function () {
        function formatCurrency(value) {
            return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        try {
            const response = await fetch('https://localhost:7020/api/v1/badminton-courts');
            const data = await response.json();
            if (data.statusCode === 200) {
                const courtData = data.data;
                const courtSection = document.querySelector('#badminton-court-section');

                courtSection.innerHTML = ''; // Clear existing template

                for (const court of courtData) {
                    try {
                        const courtsResponse = await fetch(`https://localhost:7020/api/v1/courts?badmintonCourtId=${court.id}`);
                        const courtsData = await courtsResponse.json();

                        if (courtsData.statusCode === 200) {
                            const courts = courtsData.data;

                            // Calculate min and max prices
                            let minPrice = Infinity;
                            let maxPrice = 0;

                            courts.forEach(courtItem => {
                                if (courtItem.price < minPrice) {
                                    minPrice = courtItem.price;
                                }
                                if (courtItem.price > maxPrice) {
                                    maxPrice = courtItem.price;
                                }
                            });

                            const priceText = minPrice !== Infinity && maxPrice !== 0 ? `${formatCurrency(minPrice)} - ${formatCurrency(maxPrice)} vnđ` : 'N/A';

                            // Use the first image from courtImagePaths if available
                            const firstImage = court.courtImagePaths && court.courtImagePaths.length > 0 ? court.courtImagePaths[0] : 'img/default-court.jpg';

                            const courtHTML = `
                            <div class="col-lg-3 col-md-6">
                                <div class="hp-room-item set-bg" data-setbg="${firstImage}">
                                    <div class="hr-text">
                                        <h3>${court.courtName}</h3>
                                        <h2>${priceText}</h2>
                                        <table>
                                            <tbody>
                                                <tr>
                                                    <td class="r-o">Size:</td>
                                                    <td>${court.courtNumber}</td>
                                                </tr>
                                                <tr>
                                                    <td class="r-o">Start Time:</td>
                                                    <td>${court.startTime}</td>
                                                </tr>
                                                <tr>
                                                    <td class="r-o">End Time:</td>
                                                    <td>${court.endTime}</td>
                                                </tr>
                                                <tr>
                                                    <td class="r-o">Address:</td>
                                                    <td>${court.address}</td>
                                                </tr>
                                                <tr>
                                                    <td class="r-o">Rating:</td>
                                                    <td>${court.rating}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <a href="/BadmintonCourt/Details/${court.id}" class="primary-btn">More Details</a>
                                    </div>
                                </div>
                            </div>`;
                            courtSection.innerHTML += courtHTML;

                            // Set background images for each court item
                            document.querySelectorAll('.set-bg').forEach(item => {
                                const bg = item.getAttribute('data-setbg');
                                item.style.backgroundImage = `url(${bg})`;
                            });
                        } else {
                            console.error('Failed to fetch courts data: ', courtsData.message);
                        }
                    } catch (error) {
                        console.error('Error fetching courts data: ', error);
                    }
                }
            } else {
                console.error('Failed to fetch data: ', data.message);
            }
        } catch (error) {
            console.error('Error fetching data: ', error);
        }
    });

    document.addEventListener('DOMContentLoaded', function () {
        const startTimeInput = document.getElementById('start-time');
        const endTimeInput = document.getElementById('end-time');

        function validateTimeInput(event) {
            const value = event.target.value;
            const [hours, minutes] = value.split(':').map(Number);

            if (minutes !== 0 && minutes !== 30) {
                event.target.setCustomValidity('Please select a time in increments of 30 minutes.');
            } else {
                event.target.setCustomValidity('');
            }
        }

        function validateEndTime() {
            const startTime = startTimeInput.value;
            const endTime = endTimeInput.value;

            if (startTime && endTime) {
                const [startHours, startMinutes] = startTime.split(':').map(Number);
                const [endHours, endMinutes] = endTime.split(':').map(Number);

                const start = new Date();
                start.setHours(startHours, startMinutes);

                const end = new Date();
                end.setHours(endHours, endMinutes);

                const difference = (end - start) / (1000 * 60); // difference in minutes

                if (difference < 30) {
                    endTimeInput.setCustomValidity('End Time must be at least 30 minutes after Start Time.');
                } else {
                    endTimeInput.setCustomValidity('');
                }
            }
        }

        startTimeInput.addEventListener('input', validateTimeInput);
        endTimeInput.addEventListener('input', validateTimeInput);
        endTimeInput.addEventListener('input', validateEndTime);

        const bookingForm = document.getElementById('booking-form');
        if (bookingForm) {
            bookingForm.addEventListener('submit', function (event) {
                validateEndTime();

                if (!startTimeInput.validity.valid || !endTimeInput.validity.valid) {
                    event.preventDefault();
                    alert('Please select valid start and end times.');
                }
            });
        }
    });
</script>